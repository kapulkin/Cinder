<!DOCTYPE html>
<html lang="en">
	<head>
		<title>three.js webgl - geometry - cube</title>
		<meta charset="utf-8">
		<style>
			body{
				margin: 0;
				padding: 0;
			}

			#gl-sample {
				margin: 0px;
				background-color: #000000;
				overflow: hidden;
				width: 640px;
				height: 400px;
				padding: 0
			}
		</style>
	</head>
	<body>
		<!-- <img src="crate.gif" crossorigin> -->
		<script src="three.min.js"></script>
		<div id="gl-sample"></div>

		<script>

			var camera, scene, renderer;
			var mesh;
			var rootDir = location.href.substring(0, location.href.lastIndexOf('/')) + "/";
			if( ! window.root ){
				window.root = "";
				console.log("SET WINDOW ROOT: " + window.root);
			}

			console.log( location.href.substring(0, location.href.lastIndexOf('/')));
		


			init();
			animate();

			function init() {
				var asset_crate = 'crate.gif';
				console.log("asset_crate: " + asset_crate);

				// THREE.ImageUtils.crossOrigin = "anonymous";
				renderer = new THREE.WebGLRenderer();
				renderer.setPixelRatio( window.devicePixelRatio );
				renderer.setSize( 640, 400 );
				// document.body.appendChild( renderer.domElement );
				document.getElementById("gl-sample").appendChild( renderer.domElement );

				//

				camera = new THREE.PerspectiveCamera( 70, 640 / 400, 1, 1000 );
				camera.position.z = 400;

				scene = new THREE.Scene();

				var geometry = new THREE.BoxGeometry( 200, 200, 200 );

				// var image = new Image();
				// image.crossOrigin = "anonymous";
				// var self = this;

				
				
				// image.setAttribute('crossorigin', 'anonymous');
				// image.onload = function(){
					var texture = THREE.ImageUtils.loadTexture( asset_crate );
					texture.anisotropy = renderer.getMaxAnisotropy();

					var material = new THREE.MeshBasicMaterial( { map: texture } );

					mesh = new THREE.Mesh( geometry, material );
					scene.add( mesh );
					console.log(mesh);
				// };
				// image.src = asset_crate;



				
				
				

			}


			function animate() {

				requestAnimationFrame( animate );

				if( mesh ){
					mesh.rotation.x += 0.005;
					mesh.rotation.y += 0.01;

					renderer.render( scene, camera );	
				}

			}

		</script>
	</body>
</html>

